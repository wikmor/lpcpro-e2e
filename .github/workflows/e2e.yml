name: E2E Tests

on:
  workflow_dispatch:
  repository_dispatch:
    types: [run-e2e-tests]

jobs:
  e2e-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Download LPC-Pro JAR artifact from private repo
        uses: actions/download-artifact@v4
        with:
          name: ${{ github.event.client_payload.artifact_name }}
          path: ./plugins
          github-token: ${{ secrets.LPCPRO_REPO_PAT }}
          repository: wikmor/lpcpro
          run-id: ${{ github.event.client_payload.build_run_id }}

      - name: List plugin jar
        run: ls -lh plugins/
